<!DOCTYPE html>
<html>
    <head>
        <meta charset="UTF-8" />
        <meta name="robots" content="noindex,nofollow">        
        
        <!--During development turn off caching-->
        <meta http-equiv="cache-control" content="max-age=0" />
        <meta http-equiv="cache-control" content="no-cache" />
        <meta http-equiv="expires" content="0" />
        <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
        <meta http-equiv="pragma" content="no-cache" />        
        
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=Edge" /><!-- TODO: remove this? -->
        <title>SWordy</title>
        <link rel="stylesheet" href="css/fabric.min.css">
        <link rel="stylesheet" href="css/fabric.components.min.css">
        <link rel="stylesheet" href="css/style.css">
        <link rel="stylesheet" href="css/message_bar.css">
        <link rel="stylesheet" href="css/check_stata_connection_taskpane.css">
        <script src="js/jquery.js"></script>
        <script src="js/fabric.min.js"></script>
        <script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js" type="text/javascript"></script>        
        <script src="js/msgpack.min.js"></script>
        <script src="js/swire4js.js"></script>
        <script src="js/message_bar.js"></script>
        <script src="js/check_stata_connection_taskpane.js" type="text/javascript"></script>          
    </head>
    <body>
        <h1 class="panel-title ms-font-xl ms-fontWeight-regular ms-fontColor-magenta"><img src="img/check_stata_connection_icon/check_stata_connection_icon_24x24.png" alt="Check Stata connection" class="panel-icon">Check Stata connection</h1>
        <div id="success-msg" class="ms-MessageBar ms-MessageBar--success ms-u-slideDownIn20">
            <div class="ms-MessageBar-content">
                <div class="ms-MessageBar-icon">
                    <i class="ms-Icon ms-Icon--Completed"></i>
                </div>
                <div class="ms-MessageBar-text">
                    <div class="mb-content"></div>
                    <a class="mb-close-link ms-Link" href="#">Close this</a> 
                </div>
            </div>
        </div> 
        <div id="error-msg" class="ms-MessageBar ms-MessageBar--error ms-u-slideDownIn20">
            <div class="ms-MessageBar-content">
                <div class="ms-MessageBar-icon">
                    <i class="ms-Icon ms-Icon--StatusErrorFull"></i>
                </div>
                <div class="ms-MessageBar-text">
                    <div class="mb-content"></div>
                    <a class="mb-close-link ms-Link" href="#">Close this</a>               
                </div>
            </div>
        </div>
        <div id="checkStataConnectionSpinner" class="ms-Spinner">
          <div class="ms-Spinner-label">Trying connection to Stata</div>
        </div>        
        <button id="checkStataConnectionButton" class="ms-Button ms-Button--primary" style="display: none;" title="Check Stata connection">
            <span class="ms-Button-label">Check</span>
        </button>
        <div id="troubleshooting">
            <h2 class="ms-font-l">It seems that something went wrong. Check in order the following points:</h2>
            <ul>
                <li class="troubleshooting-item troubleshooting-item-close">
                    <span class="troubleshooting-item-title ms-font-m ms-fontColor-themePrimary">
                        Check if Stata is running and its version is >= 13.
                    </span>
                    <div class="troubleshooting-item-instructions ms-font-m troubleshooting-item-hidden">
                        Stata must be running when using SWordy.
                        At least version >= 13 is needed (it is a requirement of SWire).
                        Type the Stata command "<code>version</code>" to find out if your Stata version is >= 13.
                    </div>
                </li>
                <li class="troubleshooting-item troubleshooting-item-close">
                    <span class="troubleshooting-item-title ms-font-m ms-fontColor-themePrimary">
                        Check if SWire is installed in Stata and its version is >= 0.2.
                    </span>
                    <div class="troubleshooting-item-instructions ms-font-m troubleshooting-item-hidden">
                        Type "<code>swire version</code>" in Stata to find out if SWire is installed in Stata and its version >= 0.2.
                        If SWire is not installed, download version >= 0.2 from <a class="ms-Link" target="_blank" href="https://sourceforge.net/projects/swire">here</a>.
                    </div>
                </li>
                <li class="troubleshooting-item troubleshooting-item-close">
                    <span class="troubleshooting-item-title ms-font-m ms-fontColor-themePrimary">
                        Check if the SWire HTTPS server is running inside Stata on port 50000.
                    </span>
                    <div class="troubleshooting-item-instructions ms-font-m troubleshooting-item-hidden">
                        Type "<code>swire status</code>" in Stata to find out if the SWire HTTPS local server is listening on port 50000.
                        Although the SWire server can run in HTTP or HTTPS mode, SWordy can communicate only with the SWire HTTPS server.
                        If SWire is not listening, type "swire start, https" in Stata to start the SWire HTTPS server.
                        If the server can not bind to port 50000, stop any software which is using that port.
                    </div>
                </li>
                <li class="troubleshooting-item troubleshooting-item-close">
                    <span class="troubleshooting-item-title ms-font-m ms-fontColor-themePrimary">
                        Check if you can connect to the SWire server.
                    </span>
                    <div class="troubleshooting-item-instructions ms-font-m troubleshooting-item-hidden">
                        In order to check if you can connect to the SWire HTTPS server, try to open the following web page by using Internet Explorer or Microsoft Edge: <a class="ms-Link" target="_blank" href="https://localhost:50000/test">https://localhost:50000/test</a>.
                        Using a different web browser is not a valid check, because Word internally uses Internet Explorer / Microsoft Edge. If you can not view that page, you must install the SWire security certificate in your system to allow Internet Explorer / Microsoft Edge.
                        To install the SWire security certificate follow these instructions: 1) Open Internet Explore as administrator; 2) Select "Options..."; 3) Select the "x" tab; 4) Click on "Certificates"; 5) Click on "Trusted..."; 6) Click on "Install certificate"; 7) Choose the swire.cer file from the folder where SWire has been installed.
                    </div>
                </li>
            </ul>
        </div>
    </body>
</html>